<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Âæ≥Ê¥≤‰ºö‰ΩìÊìç„ÇØ„É©„Éñ„ÄÄËã±ÂçòË™ûÔºàWeek 10Ôºâ„ÇØ„Ç§„Ç∫</title>
  <style>
    :root{
      --purple-dark1:#05020a;
      --purple-dark2:#12041f;
      --purple-dark3:#240838;
      --card:#ffffff;
      --text:#1a1333;
      --correct:#18a558;
      --wrong:#ff4d6d;
    }

    html,body{
      height:100svh; margin:0; overflow:hidden;
      background:
        radial-gradient(900px 600px at 25% 20%, rgba(255,255,255,.04), transparent 70%),
        radial-gradient(700px 500px at 70% 30%, rgba(255,255,255,.03), transparent 65%),
        linear-gradient(165deg, var(--purple-dark1), var(--purple-dark2) 55%, var(--purple-dark3));
      background-size:200% 200%;
      animation: sheen 24s ease-in-out infinite;
      display:flex; align-items:center; justify-content:center; padding:16px;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic UI",sans-serif;
      color:#fff;
    }
    @keyframes sheen{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    .app{width:min(720px,100%); height:100%; display:flex; flex-direction:column; justify-content:center; gap:10px;}

    .title{
      text-align:center; font-weight:800; letter-spacing:.04em; line-height:1.2;
      margin:0; font-size:clamp(18px,3.5vw,26px); color:#fff4b0;
      text-shadow:0 2px 12px rgba(0,0,0,.55), 0 0 20px rgba(255,244,176,.35);
    }
    .title .date{ font-size:.75em; font-weight:700; color:#ffeeb5; margin-left:.5em; opacity:.95 }

    .status{ display:flex; justify-content:space-between; align-items:center; font-size:clamp(12px,2.5vw,14px); opacity:.9; color:#efeefe }

    .card{
      background:var(--card); color:var(--text); border-radius:18px;
      box-shadow:0 12px 32px rgba(0,0,0,.35);
      padding:14px;
      display:flex; flex-direction:column;
      height:calc(100% - 70px); /* fit within viewport with title/status */
    }

    .word{
      background:#f8f7fc; border-radius:14px; padding:12px;
      display:flex; justify-content:center; align-items:center; gap:8px;
      box-shadow:inset 0 0 0 2px #eee; margin-bottom:10px; min-height:84px;
    }
    .word .text{font-size:clamp(28px,6vw,48px); font-weight:800; letter-spacing:.02em}
    .speak{
      border:none; background:#fff; border:2px solid #e8e3ff; border-radius:12px;
      padding:8px 10px; cursor:pointer; font-size:22px; line-height:1;
      box-shadow:0 2px 8px rgba(0,0,0,.08);
      transition:transform .05s ease, border-color .2s, background .2s
    }
    .speak:active{transform:scale(.95)}

    .choices{
      display:grid; grid-template-columns:1fr 1fr; gap:10px; align-content:start;
    }
    .choice{
      background:#ffffff; border:2px solid #eceaff; border-radius:12px;
      padding:14px 14px; font-size:clamp(16px,3.8vw,20px); font-weight:800; text-align:center;
      cursor:pointer; transition:transform .05s ease, box-shadow .2s, border-color .2s, background .2s;
      box-shadow:0 2px 8px rgba(0,0,0,.06); color:#2b1d55
    }
    .choice:active{transform:scale(.99)}
    .choice.correct{border-color:var(--correct); background:#e8fff3; color:#0b6a3f}
    .choice.incorrect{border-color:var(--wrong); background:#fff0f3; color:#8b1230}
    .choice[disabled]{opacity:.95; cursor:not-allowed}

    .controls{
      display:flex; gap:10px; justify-content:center; align-items:center;
      margin-top:10px;
    }
    .btn{
      background:#f3f1ff; color:#2b1d55; border:2px solid #dcd6ff; border-radius:12px;
      padding:10px 16px; font-weight:900; letter-spacing:.02em; cursor:pointer;
      backdrop-filter:blur(4px); transition:transform .05s ease, background .2s, border-color .2s
    }
    .btn:active{transform:scale(.98)}
    .btn.primary{background:#3b2bbf; border-color:#b9b2ff; color:#fff}
    .btn.hidden{display:none}
    .hidden{display:none !important}

    .result{ text-align:center; color:#2b1d55; margin-top:8px; font-weight:900 }
    .final .card{ justify-content:center; }
    .final .result{ font-size:clamp(26px,6vw,40px); color:#3b2bbf; }
  </style>
</head>
<body>
  <div class="app">
    <h1 class="title">Âæ≥Ê¥≤‰ºö‰ΩìÊìç„ÇØ„É©„Éñ„ÄÄËã±ÂçòË™ûÔºàWeek 10Ôºâ„ÇØ„Ç§„Ç∫ <span class="date">2025/9/10</span></h1>

    <div class="status">
      <span id="progress">1 / 15</span>
      <span id="score">„Çπ„Ç≥„Ç¢Ôºö0</span>
    </div>

    <div class="card">
      <div class="word">
        <div id="word" class="text">Loading...</div>
        <button id="speakBtn" class="speak" title="Áô∫Èü≥„ÇíËÅ¥„Åè" aria-label="Áô∫Èü≥„ÇíËÅ¥„Åè">üì¢</button>
      </div>

      <div id="choices" class="choices"></div>

      <div class="controls">
        <button id="nextBtn" class="btn primary hidden">Ê¨°„Å∏ ‚ñ∂</button>
        <button id="restartBtn" class="btn hidden">„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÇÑ„Çã</button>
      </div>

      <div id="result" class="result" aria-live="polite"></div>
    </div>
  </div>

  <script>
    const QUESTIONS = [
      { w: "thick",      a: ["Âéö„ÅÑ","ËñÑ„ÅÑ","ËªΩ„ÅÑ","ÈÄü„ÅÑ"], c: 0 },
      { w: "proud",      a: ["Ë™á„Çä„Å´ÊÄù„ÅÜ","ÊÅ•„Åö„Åã„Åó„ÅÑ","ÊÄñ„ÅÑ","ÊÇ≤„Åó„ÅÑ"], c: 0 },
      { w: "necessary",  a: ["ÂøÖË¶Å„Å™","‰∏çÂèØËÉΩ„Å™","Á∞°Âçò„Å™","Âç±Èô∫„Å™"], c: 0 },
      { w: "honest",     a: ["Ê≠£Áõ¥„Å™","Â§±Á§º„Å™","‰∏äÊâã„Å™","Èùô„Åã„Å™"], c: 0 },
      { w: "lonely",     a: ["„Åï„Å≥„Åó„ÅÑ","Âøô„Åó„ÅÑ","„Å´„Åé„ÇÑ„Åã„Å™","Âç±„Å™„ÅÑ"], c: 0 },
      { w: "serious",    a: ["„Åæ„Åò„ÇÅ„Å™","„Åä„ÇÇ„Åó„Çç„ÅÑ","ÂÖÉÊ∞ó„Å™","„ÅÜ„Çã„Åï„ÅÑ"], c: 0 },
      { w: "correct",    a: ["Ê≠£„Åó„ÅÑ","ÈñìÈÅï„Å£„Åü","Êöó„ÅÑ","È´ò„ÅÑ"], c: 0 },
      { w: "artificial", a: ["‰∫∫Â∑•„ÅÆ","Ëá™ÁÑ∂„ÅÆ","ÂõΩÁî£„ÅÆ","‰ºùÁµ±ÁöÑ„Å™"], c: 0 },
      { w: "familiar",   a: ["„Çà„ÅèÁü•„Å£„Å¶„ÅÑ„Çã","‰∏çÊòé„Å™","Âç±Èô∫„Å™","ÁâπÂà•„Å™"], c: 0 },
      { w: "specific",   a: ["ÂÖ∑‰ΩìÁöÑ„Å™","‰∏ÄËà¨ÁöÑ„Å™","Âêå„Åò","Âè§„ÅÑ"], c: 0 },
      { w: "worried",    a: ["ÂøÉÈÖç„Åó„Å¶„ÅÑ„Çã","Âñú„Çì„Åß„ÅÑ„Çã","ÊÄí„Å£„Å¶„ÅÑ„Çã","ÈÄÄÂ±à„Åó„Å¶„ÅÑ„Çã"], c: 0 },
      { w: "strict",     a: ["Âé≥„Åó„ÅÑ","ÂÑ™„Åó„ÅÑ","Âº±„ÅÑ","Â∫É„ÅÑ"], c: 0 },
      { w: "exhausted",  a: ["„Å∏„Å®„Å∏„Å®„ÅÆ","Áú†„ÅÑ","Á©∫ËÖπ„ÅÆ","ÈÄÄÂ±à„Å™"], c: 0 },
      { w: "exactly",    a: ["Ê≠£Á¢∫„Å´","„Åü„Å∂„Çì","„Å†„ÅÑ„Åü„ÅÑ","Â∞ë„Åó"], c: 0 },
      { w: "fluently",   a: ["ÊµÅ„Å°„Çá„ÅÜ„Å´","„ÇÜ„Å£„Åè„Çä„Å®","Èùô„Åã„Å´","„Åç„Çå„ÅÑ„Å´"], c: 0 },
    ];

    function shuffle(arr){
      const a = [...arr];
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    // ====== High-quality English voice selection ======
    let EN_VOICE = null;
    const EN_PRIORITY_NAMES = [
      // iOS/macOS quality voices
      "Samantha","Alex","Daniel","Karen","Moira","Tessa","Serena",
      // Google voices (Android/Chrome)
      "Google US English","Google UK English Female","Google UK English Male",
      // Windows
      "Microsoft Zira","Microsoft Guy","Microsoft Aria","Microsoft James"
    ];
    const isEnglish = v => v && /^en(-|_|$)/i.test(v.lang || "");

    function pickEnglishVoice(){
      const voices = speechSynthesis.getVoices();
      if(!voices || !voices.length) return null;

      // 1) Exact priority names first
      for(const name of EN_PRIORITY_NAMES){
        const m = voices.find(v => v.name === name && isEnglish(v));
        if(m) return m;
      }
      // 2) Any English voice (prefer US/GB)
      const prefer = voices.find(v => isEnglish(v) && /(US|GB|GBR|UK)/i.test(v.lang));
      if(prefer) return prefer;

      // 3) Fallback: first English voice
      const any = voices.find(isEnglish);
      return any || null;
    }

    function ensureEnglishVoice(cb){
      // some browsers load voices async
      const tryPick = () => {
        if(!EN_VOICE){
          EN_VOICE = pickEnglishVoice();
        }
        if(EN_VOICE){
          cb && cb();
        }else{
          // wait a bit more
          setTimeout(tryPick, 150);
        }
      };
      if (speechSynthesis.getVoices().length) {
        EN_VOICE = pickEnglishVoice();
        cb && cb();
      } else {
        speechSynthesis.onvoiceschanged = () => {
          EN_VOICE = pickEnglishVoice();
          cb && cb();
        };
        tryPick();
      }
    }
    // ================================================

    // Simple sound effects
    let audioCtx = null;
    function tone(freq=440, dur=0.18, type='sine', vol=0.15){
      try{
        audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type; o.frequency.value = freq; g.gain.value = vol;
        o.connect(g); g.connect(audioCtx.destination);
        o.start();
        const now = audioCtx.currentTime;
        g.gain.setValueAtTime(vol, now);
        g.gain.exponentialRampToValueAtTime(0.0001, now + dur);
        o.stop(now + dur);
      }catch(e){}
    }
    function sfxCorrect(){ tone(880, 0.18, 'sine'); }
    function sfxWrong(){ tone(220, 0.22, 'sawtooth', 0.12); }

    let order = shuffle([...Array(QUESTIONS.length).keys()]);
    let idx = 0;
    let score = 0;

    const wordEl = document.getElementById('word');
    const choicesEl = document.getElementById('choices');
    const progressEl = document.getElementById('progress');
    const scoreEl = document.getElementById('score');
    const nextBtn = document.getElementById('nextBtn');
    const restartBtn = document.getElementById('restartBtn');
    const resultEl = document.getElementById('result');
    const speakBtn = document.getElementById('speakBtn');

    function render(){
      resultEl.textContent = '';
      nextBtn.classList.add('hidden');
      restartBtn.classList.add('hidden');
      document.body.classList.remove('final');

      if(idx >= order.length){
        wordEl.textContent = '„Åä„Å§„Åã„Çå„Åï„ÅæÔºÅ';
        choicesEl.innerHTML = '';
        resultEl.textContent = `ÁµêÊûúÔºö${score} / ${QUESTIONS.length}`;
        nextBtn.classList.add('hidden');
        restartBtn.classList.remove('hidden');   // Play Again
        speakBtn.classList.add('hidden');        // Hide megaphone on final page
        progressEl.textContent = `${QUESTIONS.length} / ${QUESTIONS.length}`;
        document.body.classList.add('final');
        try{ restartBtn.focus(); }catch(e){}
        return;
      }

      const q = QUESTIONS[order[idx]];
      wordEl.textContent = q.w;
      speakBtn.classList.remove('hidden');
      progressEl.textContent = `${idx+1} / ${QUESTIONS.length}`;
      scoreEl.textContent = `„Çπ„Ç≥„Ç¢Ôºö${score}`;

      const optionIdxs = shuffle([0,1,2,3]);
      choicesEl.innerHTML = '';
      optionIdxs.forEach(i=>{
        const btn = document.createElement('button');
        btn.className = 'choice';
        btn.textContent = q.a[i];
        btn.onclick = () => handleAnswer(i === q.c, q.c, btn);
        choicesEl.appendChild(btn);
      });
    }

    function handleAnswer(isCorrect, correctIndex, clickedBtn){
      const buttons = [...document.querySelectorAll('.choice')];
      buttons.forEach(b=> b.disabled = true);

      clickedBtn.classList.add(isCorrect ? 'correct' : 'incorrect');
      const q = QUESTIONS[order[idx]];
      buttons.forEach(b=>{ if(b.textContent === q.a[correctIndex]) b.classList.add('correct'); });

      if(isCorrect){ score++; sfxCorrect(); } else { sfxWrong(); }
      scoreEl.textContent = `„Çπ„Ç≥„Ç¢Ôºö${score}`;
      nextBtn.classList.remove('hidden');
    }

    nextBtn.addEventListener('click', ()=>{ idx++; render(); });

    restartBtn.addEventListener('click', ()=>{
      score = 0; idx = 0; order = shuffle([...Array(QUESTIONS.length).keys()]);
      render();
    });

    function speak(text){
      try{
        const u = new SpeechSynthesisUtterance(text);
        // Ensure English voice
        u.voice = EN_VOICE || null;
        u.lang  = (EN_VOICE && EN_VOICE.lang) ? EN_VOICE.lang : 'en-US';
        u.rate  = 0.95;
        u.pitch = 1.0;
        speechSynthesis.cancel();
        speechSynthesis.speak(u);
      }catch(e){}
    }

    speakBtn.addEventListener('click', ()=>{
      const showing = wordEl.textContent.trim();
      if(showing && showing !== '„Åä„Å§„Åã„Çå„Åï„ÅæÔºÅ'){
        ensureEnglishVoice(() => speak(showing));
      }
    });

    // Preload English voice asap
    ensureEnglishVoice();

    render();
  </script>
</body>
</html>
